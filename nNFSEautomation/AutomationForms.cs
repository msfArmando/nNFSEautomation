using OpenQA.Selenium;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace nNFSEautomation
{
    public class AutomationForms
    {
        private static string _day => Automations.DayOfDateRequest.ToString();
        private static string _month => Automations.MonthOfDateRequest.ToString();
        private static string _year => Automations.YearOfDateRequest.ToString();
        private static string _lastDay => HelperPath.ValidationToReturnElement(PathsToAutomations.ByTodayDate, 1, 5).GetAttribute("value").Substring(0, 2);
        private static string _lastMonth => HelperPath.ValidationToReturnElement(PathsToAutomations.ByTodayDate, 1, 5).GetAttribute("value").Substring(3, 2);
        private static string _lastYear => HelperPath.ValidationToReturnElement(PathsToAutomations.ByTodayDate, 1, 5).GetAttribute("value").Substring(6, 4);
        public static string GetForms()
        {
            IWebElement viewState = HelperPath.ValidationToReturnElement(PathsToAutomations.ByViewState, 1, 5);
            var viewStateValue = viewState.GetAttribute("value");
            viewStateValue = Uri.EscapeDataString(viewStateValue);

            return $"j_idt62=j_idt62&j_idt62%3Aj_idt64=EMISSAO&j_idt62%3AidDataInicio_input={_day}%2F{_month}%2F{_year}&j_idt62%3AidDataFim_input={_lastDay}%2F{_lastMonth}%2F{_lastYear}&j_idt62%3AidFaixaNumeroDe%3AidInteiro=&j_idt62%3AidFaixaNumeroAte%3AidInteiro=&j_idt62%3AidAtiva_input=on&j_idt62%3AidCancelada_input=on&j_idt62%3Aj_idt101=EMITIDAS&j_idt62%3AlistEntityDataTableNotaFiscal%3AidDataTable_rppDD=50&j_idt62%3AlistEntityDataTableNotaFiscal%3AidDataTable_columnOrder=j_idt62%3AlistEntityDataTableNotaFiscal%3AidDataTable%3Aj_idt145%3A0%2Cj_idt62%3AlistEntityDataTableNotaFiscal%3AidDataTable%3Aj_idt145%3A1%2Cj_idt62%3AlistEntityDataTableNotaFiscal%3AidDataTable%3Aj_idt145%3A2%2Cj_idt62%3AlistEntityDataTableNotaFiscal%3AidDataTable%3Aj_idt145%3A3%2Cj_idt62%3AlistEntityDataTableNotaFiscal%3AidDataTable%3Aj_idt145%3A4%2Cj_idt62%3AlistEntityDataTableNotaFiscal%3AidDataTable%3Aj_idt145%3A5%2Cj_idt62%3AlistEntityDataTableNotaFiscal%3AidDataTable%3Aj_idt145%3A6%2Cj_idt62%3AlistEntityDataTableNotaFiscal%3AidDataTable%3Aj_idt145%3A7&j_idt62%3AlistEntityDataTableNotaFiscal%3AplReportGroup_source_filter=&j_idt62%3AlistEntityDataTableNotaFiscal%3AplReportGroup_source=%7Blabel%26%23x3D%3BSitua%C3%A7%C3%A3o%2C+attribute%26%23x3D%3BsituacaoDescription%7D&j_idt62%3AlistEntityDataTableNotaFiscal%3AplReportGroup_source=%7Blabel%26%23x3D%3BNr.+Nota%2C+attribute%26%23x3D%3BnumeroNota%7D&j_idt62%3AlistEntityDataTableNotaFiscal%3AplReportGroup_source=%7Blabel%26%23x3D%3BN%C3%BAmero+RPS%2C+attribute%26%23x3D%3BnumeroRps%7D&j_idt62%3AlistEntityDataTableNotaFiscal%3AplReportGroup_source=%7Blabel%26%23x3D%3BEmiss%C3%A3o%2C+attribute%26%23x3D%3BdataHoraEmissao%7D&j_idt62%3AlistEntityDataTableNotaFiscal%3AplReportGroup_source=%7Blabel%26%23x3D%3BCompet%C3%AAncia%2C+attribute%26%23x3D%3Bcompetencia%7D&j_idt62%3AlistEntityDataTableNotaFiscal%3AplReportGroup_source=%7Blabel%26%23x3D%3BPagamento%2C+attribute%26%23x3D%3BdataPagamento%7D&j_idt62%3AlistEntityDataTableNotaFiscal%3AplReportGroup_source=%7Blabel%26%23x3D%3BCPF%26%23x2F%3BCNPJ%2C+attribute%26%23x3D%3BcpfCnpjEmissor%7D&j_idt62%3AlistEntityDataTableNotaFiscal%3AplReportGroup_source=%7Blabel%26%23x3D%3BCPF%26%23x2F%3BCNPJ%2C+attribute%26%23x3D%3BcpfCnpjPessoa%7D&j_idt62%3AlistEntityDataTableNotaFiscal%3AplReportGroup_source=%7Blabel%26%23x3D%3BC%C3%B3digo+Obra+%28CO%29%2C+attribute%26%23x3D%3BcodigoObra%7D&j_idt62%3AlistEntityDataTableNotaFiscal%3AplReportGroup_source=%7Blabel%26%23x3D%3BValor+Servi%C3%A7o%2C+attribute%26%23x3D%3BvalorServico%7D&j_idt62%3AlistEntityDataTableNotaFiscal%3AplReportGroup_source=%7Blabel%26%23x3D%3BValor+Dedu%C3%A7%C3%A3o%2C+attribute%26%23x3D%3BvalorTotalDeducao%7D&j_idt62%3AlistEntityDataTableNotaFiscal%3AplReportGroup_target_filter=&j_idt62%3AlistEntityDataTableNotaFiscal%3AplReportOrder_source_filter=&j_idt62%3AlistEntityDataTableNotaFiscal%3AplReportOrder_source=%7Blabel%26%23x3D%3BSitua%C3%A7%C3%A3o%2C+attribute%26%23x3D%3BsituacaoDescription%7D&j_idt62%3AlistEntityDataTableNotaFiscal%3AplReportOrder_source=%7Blabel%26%23x3D%3BNr.+Nota%2C+attribute%26%23x3D%3BnumeroNota%7D&j_idt62%3AlistEntityDataTableNotaFiscal%3AplReportOrder_source=%7Blabel%26%23x3D%3BN%C3%BAmero+RPS%2C+attribute%26%23x3D%3BnumeroRps%7D&j_idt62%3AlistEntityDataTableNotaFiscal%3AplReportOrder_source=%7Blabel%26%23x3D%3BEmiss%C3%A3o%2C+attribute%26%23x3D%3BdataHoraEmissao%7D&j_idt62%3AlistEntityDataTableNotaFiscal%3AplReportOrder_source=%7Blabel%26%23x3D%3BCompet%C3%AAncia%2C+attribute%26%23x3D%3Bcompetencia%7D&j_idt62%3AlistEntityDataTableNotaFiscal%3AplReportOrder_source=%7Blabel%26%23x3D%3BPagamento%2C+attribute%26%23x3D%3BdataPagamento%7D&j_idt62%3AlistEntityDataTableNotaFiscal%3AplReportOrder_source=%7Blabel%26%23x3D%3BCPF%26%23x2F%3BCNPJ%2C+attribute%26%23x3D%3BcpfCnpjEmissor%7D&j_idt62%3AlistEntityDataTableNotaFiscal%3AplReportOrder_source=%7Blabel%26%23x3D%3BCPF%26%23x2F%3BCNPJ%2C+attribute%26%23x3D%3BcpfCnpjPessoa%7D&j_idt62%3AlistEntityDataTableNotaFiscal%3AplReportOrder_source=%7Blabel%26%23x3D%3BC%C3%B3digo+Obra+%28CO%29%2C+attribute%26%23x3D%3BcodigoObra%7D&j_idt62%3AlistEntityDataTableNotaFiscal%3AplReportOrder_source=%7Blabel%26%23x3D%3BValor+Servi%C3%A7o%2C+attribute%26%23x3D%3BvalorServico%7D&j_idt62%3AlistEntityDataTableNotaFiscal%3AplReportOrder_source=%7Blabel%26%23x3D%3BValor+Dedu%C3%A7%C3%A3o%2C+attribute%26%23x3D%3BvalorTotalDeducao%7D&j_idt62%3AlistEntityDataTableNotaFiscal%3AplReportOrder_target_filter=&j_idt62%3AlistEntityDataTableNotaFiscal%3Aj_idt166_focus=&j_idt62%3AlistEntityDataTableNotaFiscal%3Aj_idt166_input=ASC&javax.faces.ViewState={viewStateValue}&j_idt62%3AlistEntityDataTableNotaFiscal%3Aj_idt107%3AbtnDownload=j_idt62%3AlistEntityDataTableNotaFiscal%3Aj_idt107%3AbtnDownload";
        }
    }
}
